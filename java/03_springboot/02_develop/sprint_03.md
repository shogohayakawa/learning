# つぶやき登録機能の実装

## 開発要件
1. つぶやき情報をboardsテーブルに登録してください。
2. `つぶやき登録画面`について

    - `タイトル`と`つぶやき`に対してバリデーションチェックを行ってください。
    - バリデーションチェックがOKだった場合、入力されたデータを引き継いで`つぶやき登録確認画面`へ遷移してください。
    - バリデーションチェックがエラーだった場合、`つぶやき登録画面`にエラーメッセージを表示してください。
    - `つぶやき登録確認画面`から戻る場合は、`つぶやき登録確認画面`に設定されたデータを初期表示してください。
3. `つぶやき登録確認画面`について

    - `タイトル`と`つぶやき`に対してバリデーションチェックを行ってください。
    - バリデーションチェックがOKだった場合、boardsテーブルにつぶやき情報を登録し、タイムライン画面へリダイレクトしてください。
    - バリデーションチェックがエラーだった場合、`つぶやき登録画面`にエラーメッセージを表示してください。
4. URLは以下の```ルーティング定義```通りとなるよう設定してください。
5. 各アクションは以下の```画面定義```通りとなるよう実装してください。
6. 画面は`Bootstrap`を適用し、以下の`画面イメージ`を参考にデザインを調整してください。  
※`画面イメージ`と全く同じデザインとしなくても構いません

## 使用ツール
|概要|ツール|
|:---:|:---:|
|フレームワーク|Springboot|
|テンプレートエンジン|Thymeleaf|
|DB|MySQL（XAMPP / MAMP）|
|ビルドツール|Gradle|
|エディタ|Eclipse|

## テーブル定義
|テーブル名|カラム名|データ型|サイズ|必須|制約|備考|
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
|boards|id|INTEGER|-|NOT NULL|PRIMARY KEY<br>AUTO_INCREMENT|つぶやきID|
||title|VARCHAR|20|NOT NULL|-|タイトル|
||content|VARCHAR|140|NOT NULL|-|つぶやき内容|
||created_at|DATETIME|-|NULLABLE|-|登録日|
||updated_at|DATETIME|-|NULLABLE|-|更新日|

## ルーティング定義
|対象|機能|HTTPメソッド|URL|コントローラ名|メソッド名|備考|
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
|★|タイムライン画面表示|GET|/board/index|BoardController|index|つぶやき情報の一覧を表示する|
|-|つぶやき詳細画面表示|GET|/board/show/{id}|BoardController|show|つぶやき情報の詳細を表示する|
|★|つぶやき登録画面表示|GET|/board/create|BoardController|create|つぶやき登録画面を表示する|
|★|つぶやき登録確認画面表示|POST|/board/create/confirm|BoardController|createConfirm|つぶやき登録画面で入力されたつぶやき情報を表示する|
|★|つぶやき登録画面へ戻る|POST|/board/create|BoardController|createGoBack|入力されたつぶやき情報を引き継いでつぶやき登録画面を表示する|
|★|つぶやき登録処理|POST|/board/store|BoardController|store|つぶやき情報を登録しタイムライン画面へリダイレクトする|

## ファイル構成
|対象|MVC|クラス名|メソッド名|引数|戻り値|備考|
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
|★|Controller|BoardController.java|index|Model|String|全てのboardsテーブルのレコードをViewへ渡す|
|-|||show|int, Model|String|選択されたboardsテーブルのレコードをViewへ渡す|
|★|||create|Model|String|つぶやき登録画面のViewを呼び出す|
|★|||createConfirm|BoardForm, BindingResult, Model|String|つぶやき登録画面で入力されたデータをバリデーションチェックする<br>つぶやき登録画面で入力されたデータをViewへ渡す|
|★|||createGoBack|BoardForm, Model|String|つぶやき登録確認画面に設定されたデータをViewへ渡す|
|★|||store|BoardForm, BindingResult, Model, RedirectAttributes|String|つぶやき登録確認画面に設定されたデータをバリデーションチェックする<br>つぶやき登録確認画面に設定されたデータをboardsテーブルに登録する<br>タイムライン画面へリダイレクトする|
|-|Model|BoardService.java<br>（インターフェース）|getAll|-|List\<Board>|boardsテーブルのレコードを全件取得するようdaoに指示する|
|-|||getBoard|int|Board|つぶやきIDを元にboardsテーブルのレコードを1件取得するようdaoに指示する|
|★|||save|void|Board|Boardエンティティのデータをboardsテーブルへ1件登録するようdaoに指示する|
|-||BoardServiceImpl.java<br>（インターフェース実装クラス）|getAll|-|List\<Board>|boardsテーブルのレコードを全件取得するようdaoに指示する|
|-|||getBoard|int|Board|つぶやきIDを元にboardsテーブルのレコードを1件取得するようdaoに指示する|
|★|||save|void|Board|Boardエンティティのデータをboardsテーブルへ1件登録するようdaoに指示する|
|-||BoardDao.java<br>（インターフェース）|findAll|-|List\<Board>|boardsテーブルのレコードを全件取得する|
|-|||findById|int|Board|つぶやきIDを元にboardsテーブルのレコードを1件取得する|
|★|||insert|void|Board|Boardエンティティのデータをboardsテーブルへ1件登録する|
|-||BoardDaoImpl.java<br>（インターフェース実装クラス）|findAll|-|List\<Board>|boardsテーブルのレコードを「更新日/降順」で全件取得する|
|-|||findById|int|Board|つぶやきIDを元にboardsテーブルのレコードを1件取得する|
|★|||insert|void|Board|Boardエンティティのデータをboardsテーブルへ1件登録する|
|-||Board.java|-|-|-|boardsテーブルのEntityクラス<br>フィールド変数、コンストラクタ、getter・setterを定義する|
|★|View|index.html|-|-|-|タイムライン画面|
|-||show.html|-|-|-|つぶやき詳細画面|
|★||create.html|-|-|-|つぶやき登録画面|
|★||confirm.html|-|-|-|つぶやき登録確認画面|

## 画面定義
### つぶやき登録画面
- 画面イメージ（つぶやき登録ボタンから遷移）

![01](/java/images/03_springboot/02_develop/sprint_03/01.PNG)

- 画面イメージ（つぶやき確認画面から遷移）

![02](/java/images/03_springboot/02_develop/sprint_03/02.PNG)

- 画面イメージ（必須チェックエラー）

![03](/java/images/03_springboot/02_develop/sprint_03/03.PNG)

- 画面イメージ（桁数チェックエラー）

![04](/java/images/03_springboot/02_develop/sprint_03/04.PNG)

- 画面項目

|対象|画面項目1|画面項目2|種別|備考|
|:---:|:---:|:---:|:---:|:---:|
|★|ヘッダ|ページタイトル|テキスト出力|「Simple Board」と表示する<br>クリックするとタイムライン画面へ遷移する|
|★||「つぶやき登録」ボタン|ボタン|クリックするとつぶやき登録画面へ遷移する|
|★|画面タイトル|-|テキスト出力|「つぶやき登録」と表示する|
|★|つぶやき登録部|タイトルヘッダ|テキスト出力|「タイトル」と表示する|
|★||タイトル|テキストボックス|「つぶやき登録ボタン」から遷移した場合、空白を初期表示する<br>「つぶやき確認画面」から遷移した場合、入力済みのデータを初期表示する|
|★||エラーメッセージ|テキスト出力|バリデーションチェックでエラーが発生した場合、エラーメッセージを表示する（※1）|
|★||つぶやきヘッダ|テキスト出力|「つぶやき」と表示する|
|★||つぶやき|テキストエリア|「つぶやき登録ボタン」から遷移した場合、空白を表示する<br>「つぶやき確認画面」から遷移した場合、入力済みのデータを初期表示する|
|★||エラーメッセージ|テキスト出力|バリデーションチェックでエラーが発生した場合、エラーメッセージを表示する（※1）|
|★|「一覧へ戻る」ボタン|-|ボタン|クリックするとタイムライン画面へ遷移する|
|★|「つぶやき確認」ボタン|-|ボタン|クリックするとつぶやき確認画面へ遷移する|

※1）表示されるメッセージは、以下の`エラーメッセージ`参照

### つぶやき確認画面
- 画面イメージ（初期表示）

![05](/java/images/03_springboot/02_develop/sprint_03/05.PNG)

- 画面イメージ（つぶやき登録確認ダイアログ）

![06](/java/images/03_springboot/02_develop/sprint_03/06.PNG)

- 画面項目

|対象|画面項目1|画面項目2|種別|備考|
|:---:|:---:|:---:|:---:|:---:|
|★|ヘッダ|ページタイトル|テキスト出力|「Simple Board」と表示する<br>クリックするとタイムライン画面へ遷移する|
|★||「つぶやき登録」ボタン|ボタン|クリックするとつぶやき登録画面へ遷移する|
|★|画面タイトル|-|テキスト出力|「つぶやき登録確認」と表示する|
|★|つぶやき登録確認部|タイトルヘッダ|テキスト出力|「タイトル」と表示する|
|★||タイトル|テキストボックス|つぶやき登録画面で入力された値を表示する<br>画面から編集できないよう「非活性」とする|
|★||エラーメッセージ|テキスト出力|バリデーションチェックでエラーが発生した場合、エラーメッセージを表示する（※2）|
|★||つぶやきヘッダ|テキスト出力|「つぶやき」と表示する|
|★||つぶやき|テキストエリア|つぶやき登録画面で入力された値を表示する<br>画面から編集できないよう「非活性」とする|
|★||エラーメッセージ|テキスト出力|バリデーションチェックでエラーが発生した場合、エラーメッセージを表示する（※2）|
|★|「戻る」ボタン|-|ボタン|クリックするとつぶやき登録画面へ遷移する<br>「タイトル」と「つぶやき」に設定されたデータをつぶやき登録画面へ渡す|
|★|「登録」ボタン|-|ボタン|クリックするとつぶやき確認画面へ遷移する|
|★|つぶやき登録確認ダイアログ|ダイアログヘッダ|テキスト出力|「つぶやき登録確認」と表示する|
|★||ダイアログテキスト|テキスト出力|「つぶやきを登録しますか？」と表示する|
|★||「戻る」ボタン|ボタン|「つぶやき登録確認ダイアログ」を閉じる|
|★||「登録」ボタン|ボタン|「タイトル」と「つぶやき」に入力されたデータをboardsテーブルに登録する<br>タイムライン画面へリダイレクトする|

※2）表示されるメッセージは、以下の`エラーメッセージ`参照

### タイムライン画面
- 画面イメージ（フラッシュメッセージ）

![07](/java/images/03_springboot/02_develop/sprint_03/07.PNG)

- 画面項目

|対象|画面項目1|画面項目2|種別|備考|
|:---:|:---:|:---:|:---:|:---:|
|-|ヘッダ|ページタイトル|テキスト出力|「Simple Board」と表示する<br>クリックするとタイムライン画面へ遷移する|
|-||「つぶやき登録」ボタン|ボタン|クリックするとつぶやき登録画面へ遷移する<br>※現段階では実装不要|
|-|画面タイトル|-|テキスト出力|「タイムライン」と表示する|
|★|フラッシュメッセージ|-|テキスト出力|フラッシュメッセージが存在する場合は表示する（※3）|
|-|つぶやき一覧ヘッダ|タイトル|テキスト出力|-|
|-||つぶやき|テキスト出力|-|
|-||更新日|テキスト出力|-|
|-||詳細|テキスト出力|-|
|-|つぶやき一覧レコード|取得されたタイトル|テキスト出力|-|
|-||取得されたつぶやき|テキスト出力|-|
|-||取得された更新日|テキスト出力|日本時間<br>yyyy/MM/dd hh:mm形式|
|-||「みる」ボタン|ボタン|クリックするとつぶやき詳細画面へ遷移する|

※3）表示されるメッセージは、以下の`フラッシュメッセージ`参照

### エラーメッセージ

|対象|画面|画面項目|チェック内容|エラーメッセージ|
|:---:|:---:|:---:|:---:|:---:|
|★|つぶやき登録画面|タイトル|必須チェック|タイトルの入力は必須です|
|★|||桁チェック<br>（20文字）|タイトルは20文字以内で入力してください|
|★||つぶやき|必須チェック|つぶやきの入力は必須です|
|★|||桁チェック<br>（140文字）|つぶやきは140文字以内で入力してください|
|★|つぶやき確認画面|タイトル|必須チェック|タイトルの入力は必須です|
|★|||桁チェック<br>（20文字）|タイトルは20文字以内で入力してください|
|★||つぶやき|必須チェック|つぶやきの入力は必須です|
|★|||桁チェック<br>（140文字）|つぶやきは140文字以内で入力してください|

### フラッシュメッセージ

|対象|画面|表示契機|フラッシュメッセージ|
|:---:|:---:|:---:|:---:|
|★|タイムライン画面|つぶやき登録成功時|つぶやきの登録に成功しました|
